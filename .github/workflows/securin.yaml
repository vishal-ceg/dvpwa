---
name: Securin Scan
"on":
- workflow_dispatch
- pull_request
jobs:
  scanning:
    env:
      APP_ID: e7eaeb8f7097892c78c877202336a5eead0a575e9f8d901c9ca118c52ba1326c
    steps:
    - uses: actions/checkout@v2
    - name: Scan Initiated
      run: |-
        docker pull -q shiftleft-cli:latest
        docker run -v ${{github.workspace}}:/src  --volume ${{github.workspace}}:/workdir shiftleft-cli:latest -user ${{ secrets.USER_NAME }} -pass ${{ secrets.PASSWORD }} -app_id ${{ env.APP_ID }} event:${{ github.event_name }}  pr_number:${{ github.event.number }}
    - name: Upload SARIF file
      uses: github/codeql-action/upload-sarif@v1
      with:
        sarif_file: ${{github.workspace}}/results/result.sarif
      if: hashFiles('**/result.sarif') !=''
    - name: Evaluate build status
      run: |
        cat ${{github.workspace}}/results/status.txt
        exit 1
      if: hashFiles('**/status.txt') !=''
    runs-on: ubuntu-latest
